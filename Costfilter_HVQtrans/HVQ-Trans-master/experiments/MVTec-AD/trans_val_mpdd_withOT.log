nohup: ignoring inputAvailable GPUs: 2GPU 0: NVIDIA A100-PCIE-40GBGPU 1: NVIDIA A100-PCIE-40GBconfig.save_path ./checkpoints/HVQ_TR_switch_MPDD_from0_withOT[2025-03-28 22:23:25,733][train_val_withOT_mpdd.py][line:  90][    INFO] args: Namespace(config='./config_mpdd_withOT.yaml', evaluate=False, local_rank=None, train_only_four_decoder=False)[2025-03-28 22:23:25,734][train_val_withOT_mpdd.py][line:  91][    INFO] config: {'criterion': [{'kwargs': {'weight': 1.0},                'name': 'FeatureMSELoss',                'type': 'FeatureMSELoss'}], 'dataset': {'batch_size': 16,             'image_reader': {'kwargs': {'color_mode': 'RGB',                                         'image_dir': '/home/ZZ/anomaly/GLAD-main/hdd/Datasets/MPDD'},                              'type': 'opencv'},             'input_size': [224, 224],             'pixel_mean': [0.485, 0.456, 0.406],             'pixel_std': [0.229, 0.224, 0.225],             'test': {'meta_file': '../../data/MPDD/test.json'},             'train': {'hflip': False,                       'meta_file': '../../data/MPDD/train.json',                       'rebalance': False,                       'rotate': False,                       'vflip': False},             'type': 'custom',             'workers': 4}, 'evaluator': {'eval_dir': './result_eval_temp_MPDD_from0_withOT',               'key_metric': 'mean_max_auc',               'metrics': {'auc': [{'name': 'std'},                                   {'kwargs': {'avgpool_size': [16, 16]},                                    'name': 'max'},                                   {'name': 'pixel'},                                   {'name': 'top250'},                                   {'name': 'IImageap'},                                   {'name': 'IImagef1max'},                                   {'name': 'IImageauroc'},                                   {'name': 'PPixelap'},                                   {'name': 'PPixelf1max'},                                   {'name': 'PPixelpro'},                                   {'name': 'PPixelauroc'}]},               'save_dir': 'result_eval_temp_MPDD_from0_withOT',               'vis_compound': {'max_score': None,                                'min_score': None,                                'save_dir': 'checkpoints/HVQ_TR_switch_MPDD_from0/vis_compound_HVQ_TR_switch/visual_MPDD_from0_withOT'}}, 'exp_path': '.', 'frozen_layers': ['backbone'], 'log_path': './log/', 'net': [{'frozen': True,          'kwargs': {'outlayers': [1, 2, 3, 4], 'pretrained': True},          'name': 'backbone',          'type': 'models.backbones.efficientnet_b4'},         {'kwargs': {'outstrides': [16]},          'name': 'neck',          'prev': 'backbone',          'type': 'models.necks.MFCN'},         {'kwargs': {'activation': 'relu',                     'dim_feedforward': 1024,                     'dropout': 0.1,                     'feature_jitter': {'prob': 1.0, 'scale': 20.0},                     'hidden_dim': 256,                     'initializer': {'method': 'xavier_uniform'},                     'neighbor_mask': {'mask': [True, True, True],                                       'neighbor_size': [7, 7]},                     'nhead': 8,                     'normalize_before': False,                     'num_decoder_layers': 4,                     'num_encoder_layers': 4,                     'pos_embed_type': 'learned',                     'save_recon': {'save_dir': 'result_recon_MPDD_from0_withOT'}},          'name': 'reconstruction',          'prev': 'neck',          'type': 'models.reconstructions.HVQ_TR_switch_OT'}], 'port': 11111, 'random_seed': 1234, 'save_path': './checkpoints/HVQ_TR_switch_MPDD_from0_withOT', 'saver': {'always_save': False,           'auto_resume': False,           'load_path': 'checkpoints',           'log_dir': 'log/',           'resume_model': '/home/ZZ/anomaly/HVQ-Trans-master/experiments/MVTec-AD/checkpoints/HVQ_TR_switch_MPDD_from0_withOT/ckpt_best.pth.tar',           'save_dir': 'checkpoints/HVQ_TR_switch_MPDD_from0_withOT'}, 'trainer': {'clip_max_norm': 0.1,             'lr_scheduler': {'kwargs': {'gamma': 0.1, 'step_size': 800},                              'type': 'StepLR'},             'max_epoch': 1000,             'optimizer': {'kwargs': {'betas': [0.9, 0.999],                                      'lr': 0.0001,                                      'weight_decay': 0.0001},                           'type': 'AdamW'},             'print_freq_step': 50,             'tb_freq_step': 1,             'val_freq_epoch': 10}, 'version': 'v1.0.0'}[2025-03-28 22:23:26,057][       utils.py][line: 719][    INFO]  not exist, load from https://github.com/lukemelas/EfficientNet-PyTorch/releases/download/1.0/efficientnet-b4-6ed6700e.pth[2025-03-28 22:23:26,157][       utils.py][line: 740][    INFO] Loaded ImageNet pretrained efficientnet-b4[2025-03-28 22:23:34,178][train_val_withOT_mpdd.py][line: 121][    INFO] layers: ['backbone', 'neck', 'reconstruction'][2025-03-28 22:23:34,179][train_val_withOT_mpdd.py][line: 122][    INFO] active layers: ['neck', 'reconstruction']resume_model /home/ZZ/anomaly/HVQ-Trans-master/experiments/MVTec-AD/checkpoints/HVQ_TR_switch_MPDD_from0_withOT/ckpt_best.pth.tarHVQ_TR_switch_OT=> loading checkpoint '/home/ZZ/anomaly/HVQ-Trans-master/experiments/MVTec-AD/checkpoints/HVQ_TR_switch_MPDD_from0_withOT/ckpt_best.pth.tar'=> also loaded optimizer from checkpoint '/home/ZZ/anomaly/HVQ-Trans-master/experiments/MVTec-AD/checkpoints/HVQ_TR_switch_MPDD_from0_withOT/ckpt_best.pth.tar' (Epoch 0)[2025-03-28 22:23:41,909][custom_dataset.py][line:  47][    INFO] building CustomDataset from: ../../data/MPDD/train.json[2025-03-28 22:23:41,912][custom_dataset.py][line:  47][    INFO] building CustomDataset from: ../../data/MPDD/test.json/root/anaconda3/envs/Glad/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:369: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.  warnings.warn("To get the last learning rate computed by the scheduler, "[2025-03-28 22:23:44,456][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [1/1000]	Iter: [1/56000]	Time 2.54 (2.54)	Data 1.17 (1.17)	Loss 8.88694 (8.88694)	LR 0.00010	[2025-03-28 22:24:04,119][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [1/1000]	Iter: [51/56000]	Time 0.39 (0.39)	Data 0.00 (0.00)	Loss 9.00867 (8.71352)	LR 0.00010	/root/anaconda3/envs/Glad/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:154: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)[2025-03-28 22:24:25,465][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [2/1000]	Iter: [101/56000]	Time 0.39 (0.41)	Data 0.00 (0.03)	Loss 8.86029 (8.78172)	LR 0.00010	[2025-03-28 22:24:46,163][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [3/1000]	Iter: [151/56000]	Time 0.40 (0.42)	Data 0.00 (0.03)	Loss 9.36400 (8.84236)	LR 0.00010	[2025-03-28 22:25:07,036][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [4/1000]	Iter: [201/56000]	Time 0.39 (0.43)	Data 0.00 (0.04)	Loss 8.79087 (8.73889)	LR 0.00010	[2025-03-28 22:25:27,005][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [5/1000]	Iter: [251/56000]	Time 0.38 (0.42)	Data 0.00 (0.05)	Loss 9.04749 (8.89038)	LR 0.00010	[2025-03-28 22:25:47,260][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [6/1000]	Iter: [301/56000]	Time 0.39 (0.46)	Data 0.00 (0.06)	Loss 9.50397 (8.73971)	LR 0.00010	[2025-03-28 22:26:07,986][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [7/1000]	Iter: [351/56000]	Time 0.40 (0.47)	Data 0.00 (0.07)	Loss 9.57881 (8.61929)	LR 0.00010	[2025-03-28 22:26:28,801][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [8/1000]	Iter: [401/56000]	Time 0.40 (0.52)	Data 0.00 (0.13)	Loss 8.62827 (8.93228)	LR 0.00010	[2025-03-28 22:26:49,526][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [9/1000]	Iter: [451/56000]	Time 0.34 (0.76)	Data 0.00 (0.38)	Loss 8.96680 (8.85229)	LR 0.00010	[2025-03-28 22:27:09,204][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [9/1000]	Iter: [501/56000]	Time 0.38 (0.39)	Data 0.00 (0.00)	Loss 8.83330 (8.69867)	LR 0.00010	[2025-03-28 22:27:30,200][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [10/1000]	Iter: [551/56000]	Time 0.38 (0.42)	Data 0.00 (0.03)	Loss 8.24531 (8.84421)	LR 0.00010	[2025-03-28 22:27:51,039][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [11/1000]	Iter: [601/56000]	Time 0.38 (0.42)	Data 0.00 (0.03)	Loss 8.45989 (8.77890)	LR 0.00010	[2025-03-28 22:28:11,607][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [12/1000]	Iter: [651/56000]	Time 0.37 (0.42)	Data 0.00 (0.03)	Loss 8.75148 (8.85512)	LR 0.00010	[2025-03-28 22:28:32,430][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [13/1000]	Iter: [701/56000]	Time 0.36 (0.43)	Data 0.00 (0.04)	Loss 8.20625 (8.81130)	LR 0.00010	[2025-03-28 22:28:53,212][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [14/1000]	Iter: [751/56000]	Time 0.39 (0.45)	Data 0.00 (0.06)	Loss 9.32246 (8.88855)	LR 0.00010	[2025-03-28 22:29:14,328][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [15/1000]	Iter: [801/56000]	Time 0.40 (0.48)	Data 0.00 (0.08)	Loss 8.89811 (8.82094)	LR 0.00010	[2025-03-28 22:29:35,128][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [16/1000]	Iter: [851/56000]	Time 0.39 (0.50)	Data 0.00 (0.11)	Loss 8.11399 (8.72414)	LR 0.00010	[2025-03-28 22:29:55,756][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [17/1000]	Iter: [901/56000]	Time 0.40 (0.63)	Data 0.00 (0.22)	Loss 9.81664 (8.76373)	LR 0.00010	[2025-03-28 22:30:15,176][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [17/1000]	Iter: [951/56000]	Time 0.39 (0.39)	Data 0.00 (0.00)	Loss 9.25285 (8.73770)	LR 0.00010	[2025-03-28 22:30:36,118][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [18/1000]	Iter: [1001/56000]	Time 0.37 (0.42)	Data 0.00 (0.03)	Loss 8.46329 (8.75186)	LR 0.00010	[2025-03-28 22:30:57,009][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [19/1000]	Iter: [1051/56000]	Time 0.38 (0.42)	Data 0.00 (0.03)	Loss 8.26566 (8.82815)	LR 0.00010	[2025-03-28 22:31:17,870][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [20/1000]	Iter: [1101/56000]	Time 0.40 (0.43)	Data 0.00 (0.03)	Loss 8.62540 (8.68316)	LR 0.00010	[2025-03-28 22:31:38,612][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [21/1000]	Iter: [1151/56000]	Time 0.38 (0.43)	Data 0.00 (0.04)	Loss 8.46882 (8.61038)	LR 0.00010	[2025-03-28 22:31:59,607][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [22/1000]	Iter: [1201/56000]	Time 0.38 (0.45)	Data 0.00 (0.06)	Loss 9.24686 (8.88167)	LR 0.00010	[2025-03-28 22:32:20,185][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [23/1000]	Iter: [1251/56000]	Time 0.40 (0.45)	Data 0.00 (0.06)	Loss 8.09861 (8.66527)	LR 0.00010	[2025-03-28 22:32:40,791][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [24/1000]	Iter: [1301/56000]	Time 0.39 (0.49)	Data 0.00 (0.09)	Loss 8.46918 (8.61557)	LR 0.00010	[2025-03-28 22:33:01,627][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [25/1000]	Iter: [1351/56000]	Time 0.40 (0.59)	Data 0.00 (0.18)	Loss 8.63453 (8.75261)	LR 0.00010	[2025-03-28 22:33:22,342][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [26/1000]	Iter: [1401/56000]	Time 1.71 (1.71)	Data 1.30 (1.30)	Loss 10.16461 (10.16461)	LR 0.00010	[2025-03-28 22:33:41,864][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [26/1000]	Iter: [1451/56000]	Time 0.39 (0.39)	Data 0.00 (0.00)	Loss 9.23631 (8.76957)	LR 0.00010	[2025-03-28 22:34:02,646][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [27/1000]	Iter: [1501/56000]	Time 0.40 (0.42)	Data 0.00 (0.03)	Loss 8.48009 (8.72705)	LR 0.00010	[2025-03-28 22:34:23,411][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [28/1000]	Iter: [1551/56000]	Time 0.39 (0.42)	Data 0.00 (0.03)	Loss 8.72531 (8.62097)	LR 0.00010	[2025-03-28 22:34:44,057][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [29/1000]	Iter: [1601/56000]	Time 0.39 (0.43)	Data 0.00 (0.03)	Loss 8.19416 (8.75232)	LR 0.00010	Validation Progress:   0%|          | 0/458 [00:00<?, ?it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:   0%|          | 1/458 [00:01<10:28,  1.38s/it]Validation Progress:   0%|          | 2/458 [00:01<04:48,  1.58it/s]Validation Progress:   1%|          | 3/458 [00:01<03:05,  2.45it/s]Validation Progress:   1%|          | 4/458 [00:01<02:10,  3.48it/s]Validation Progress:   1%|          | 5/458 [00:01<01:40,  4.50it/s]Validation Progress:   1%|▏         | 6/458 [00:01<01:24,  5.38it/s]Validation Progress:   2%|▏         | 7/458 [00:02<01:13,  6.14it/s]Validation Progress:   2%|▏         | 8/458 [00:02<01:05,  6.89it/s]Validation Progress:   2%|▏         | 9/458 [00:02<01:00,  7.40it/s]Validation Progress:   2%|▏         | 10/458 [00:02<00:59,  7.53it/s]Validation Progress:   2%|▏         | 11/458 [00:02<00:55,  8.01it/s]Validation Progress:   3%|▎         | 12/458 [00:02<00:53,  8.32it/s]Validation Progress:   3%|▎         | 13/458 [00:02<00:51,  8.59it/s]Validation Progress:   3%|▎         | 14/458 [00:02<00:52,  8.52it/s]Validation Progress:   3%|▎         | 15/458 [00:02<00:52,  8.47it/s]Validation Progress:   3%|▎         | 16/458 [00:03<00:53,  8.21it/s]Validation Progress:   4%|▎         | 17/458 [00:03<00:54,  8.08it/s]Validation Progress:   4%|▍         | 18/458 [00:03<00:56,  7.81it/s]Validation Progress:   4%|▍         | 19/458 [00:03<00:55,  7.93it/s]Validation Progress:   4%|▍         | 20/458 [00:03<00:52,  8.41it/s]Validation Progress:   5%|▍         | 21/458 [00:03<00:51,  8.47it/s]Validation Progress:   5%|▍         | 22/458 [00:03<00:52,  8.25it/s]Validation Progress:   5%|▌         | 23/458 [00:03<00:51,  8.51it/s]Validation Progress:   5%|▌         | 24/458 [00:04<00:52,  8.27it/s]Validation Progress:   5%|▌         | 25/458 [00:04<00:54,  7.88it/s]Validation Progress:   6%|▌         | 26/458 [00:04<00:53,  8.02it/s]Validation Progress:   6%|▌         | 27/458 [00:04<00:52,  8.20it/s]Validation Progress:   6%|▌         | 28/458 [00:04<00:50,  8.46it/s]Validation Progress:   6%|▋         | 29/458 [00:04<00:51,  8.41it/s]Validation Progress:   7%|▋         | 30/458 [00:04<00:51,  8.30it/s]Validation Progress:   7%|▋         | 31/458 [00:04<00:50,  8.39it/s]Validation Progress:   7%|▋         | 32/458 [00:05<00:49,  8.64it/s]Validation Progress:   7%|▋         | 33/458 [00:05<00:47,  8.95it/s]Validation Progress:   7%|▋         | 34/458 [00:05<00:48,  8.79it/s]Validation Progress:   8%|▊         | 35/458 [00:05<00:49,  8.46it/s]Validation Progress:   8%|▊         | 36/458 [00:05<00:50,  8.36it/s]Validation Progress:   8%|▊         | 37/458 [00:05<00:48,  8.69it/s]Validation Progress:   8%|▊         | 38/458 [00:05<00:52,  8.07it/s]Validation Progress:   9%|▊         | 39/458 [00:05<00:53,  7.88it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:   9%|▊         | 40/458 [00:06<00:54,  7.60it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:   9%|▉         | 41/458 [00:06<00:57,  7.25it/s]Validation Progress:   9%|▉         | 42/458 [00:06<00:55,  7.52it/s]Validation Progress:   9%|▉         | 43/458 [00:06<00:56,  7.39it/s]Validation Progress:  10%|▉         | 44/458 [00:06<00:55,  7.39it/s]Validation Progress:  10%|▉         | 45/458 [00:06<00:54,  7.62it/s]Validation Progress:  10%|█         | 46/458 [00:06<00:53,  7.74it/s]Validation Progress:  10%|█         | 47/458 [00:06<00:52,  7.84it/s]Validation Progress:  10%|█         | 48/458 [00:07<00:51,  7.94it/s]Validation Progress:  11%|█         | 50/458 [00:07<00:46,  8.73it/s]Validation Progress:  11%|█         | 51/458 [00:07<00:47,  8.57it/s]Validation Progress:  11%|█▏        | 52/458 [00:07<00:50,  8.11it/s]Validation Progress:  12%|█▏        | 53/458 [00:07<00:47,  8.45it/s]Validation Progress:  12%|█▏        | 54/458 [00:07<00:49,  8.16it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  12%|█▏        | 55/458 [00:07<00:48,  8.34it/s]Validation Progress:  12%|█▏        | 56/458 [00:08<00:47,  8.52it/s]Validation Progress:  12%|█▏        | 57/458 [00:08<00:47,  8.48it/s]Validation Progress:  13%|█▎        | 58/458 [00:08<00:47,  8.40it/s]Validation Progress:  13%|█▎        | 59/458 [00:08<00:47,  8.38it/s]Validation Progress:  13%|█▎        | 60/458 [00:08<00:46,  8.64it/s]Validation Progress:  13%|█▎        | 61/458 [00:08<00:46,  8.59it/s]Validation Progress:  14%|█▎        | 62/458 [00:08<00:48,  8.22it/s]Validation Progress:  14%|█▍        | 63/458 [00:08<00:45,  8.61it/s]Validation Progress:  14%|█▍        | 64/458 [00:08<00:45,  8.62it/s]Validation Progress:  14%|█▍        | 65/458 [00:09<00:46,  8.51it/s]Validation Progress:  14%|█▍        | 66/458 [00:09<00:46,  8.49it/s]Validation Progress:  15%|█▍        | 67/458 [00:09<00:44,  8.85it/s]Validation Progress:  15%|█▍        | 68/458 [00:09<00:44,  8.71it/s]Validation Progress:  15%|█▌        | 69/458 [00:09<00:45,  8.64it/s]Validation Progress:  15%|█▌        | 70/458 [00:09<00:46,  8.37it/s]Validation Progress:  16%|█▌        | 71/458 [00:09<00:45,  8.45it/s]Validation Progress:  16%|█▌        | 72/458 [00:09<00:45,  8.43it/s]Validation Progress:  16%|█▌        | 73/458 [00:10<00:45,  8.41it/s]Validation Progress:  16%|█▌        | 74/458 [00:10<00:43,  8.76it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  16%|█▋        | 75/458 [00:10<00:44,  8.59it/s]Validation Progress:  17%|█▋        | 76/458 [00:10<00:45,  8.31it/s]Validation Progress:  17%|█▋        | 77/458 [00:10<00:46,  8.24it/s]Validation Progress:  17%|█▋        | 78/458 [00:10<00:45,  8.44it/s]Validation Progress:  17%|█▋        | 79/458 [00:10<00:46,  8.20it/s]Validation Progress:  17%|█▋        | 80/458 [00:10<00:46,  8.14it/s]Validation Progress:  18%|█▊        | 81/458 [00:10<00:46,  8.05it/s]Validation Progress:  18%|█▊        | 82/458 [00:11<00:47,  7.84it/s]Validation Progress:  18%|█▊        | 83/458 [00:11<00:48,  7.65it/s]Validation Progress:  18%|█▊        | 84/458 [00:11<00:48,  7.70it/s]Validation Progress:  19%|█▊        | 85/458 [00:11<00:49,  7.52it/s]Validation Progress:  19%|█▉        | 86/458 [00:11<00:49,  7.49it/s]Validation Progress:  19%|█▉        | 87/458 [00:11<00:47,  7.84it/s]Validation Progress:  19%|█▉        | 88/458 [00:11<00:46,  7.90it/s]Validation Progress:  19%|█▉        | 89/458 [00:12<00:46,  7.95it/s]Validation Progress:  20%|█▉        | 90/458 [00:12<00:44,  8.24it/s]Validation Progress:  20%|█▉        | 91/458 [00:12<00:43,  8.50it/s]Validation Progress:  20%|██        | 92/458 [00:12<00:43,  8.45it/s]Validation Progress:  20%|██        | 93/458 [00:12<00:45,  8.11it/s]Validation Progress:  21%|██        | 94/458 [00:12<00:42,  8.53it/s]Validation Progress:  21%|██        | 95/458 [00:12<00:41,  8.81it/s]Validation Progress:  21%|██        | 96/458 [00:12<00:40,  8.91it/s]Validation Progress:  21%|██        | 97/458 [00:12<00:42,  8.59it/s]Validation Progress:  21%|██▏       | 98/458 [00:13<00:44,  8.14it/s][2025-03-28 22:35:06,350][train_val_withOT_mpdd.py][line: 372][    INFO] Test: [100/458]	Time 0.149 (0.133)Validation Progress:  22%|██▏       | 100/458 [00:13<00:44,  8.09it/s]Validation Progress:  22%|██▏       | 101/458 [00:13<00:45,  7.81it/s]Validation Progress:  22%|██▏       | 102/458 [00:13<00:46,  7.59it/s]Validation Progress:  22%|██▏       | 103/458 [00:13<00:45,  7.78it/s]Validation Progress:  23%|██▎       | 104/458 [00:13<00:46,  7.67it/s]Validation Progress:  23%|██▎       | 105/458 [00:13<00:46,  7.60it/s]Validation Progress:  23%|██▎       | 106/458 [00:14<00:45,  7.76it/s]Validation Progress:  23%|██▎       | 107/458 [00:14<00:43,  8.00it/s]Validation Progress:  24%|██▍       | 109/458 [00:14<00:38,  9.08it/s]Validation Progress:  24%|██▍       | 110/458 [00:14<00:38,  9.09it/s]Validation Progress:  24%|██▍       | 111/458 [00:14<00:37,  9.20it/s]Validation Progress:  24%|██▍       | 112/458 [00:14<00:38,  9.09it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  25%|██▍       | 113/458 [00:14<00:38,  8.95it/s]Validation Progress:  25%|██▍       | 114/458 [00:14<00:39,  8.61it/s]Validation Progress:  25%|██▌       | 115/458 [00:15<00:42,  8.13it/s]Validation Progress:  25%|██▌       | 116/458 [00:15<00:42,  8.04it/s]Validation Progress:  26%|██▌       | 117/458 [00:15<00:41,  8.25it/s]Validation Progress:  26%|██▌       | 118/458 [00:15<00:41,  8.23it/s]Validation Progress:  26%|██▌       | 119/458 [00:15<00:43,  7.75it/s]Validation Progress:  26%|██▌       | 120/458 [00:15<00:42,  8.00it/s]Validation Progress:  26%|██▋       | 121/458 [00:15<00:42,  7.86it/s]Validation Progress:  27%|██▋       | 122/458 [00:16<00:43,  7.77it/s]Validation Progress:  27%|██▋       | 123/458 [00:16<00:44,  7.56it/s]Validation Progress:  27%|██▋       | 124/458 [00:16<00:46,  7.12it/s]Validation Progress:  27%|██▋       | 125/458 [00:16<00:48,  6.88it/s]Validation Progress:  28%|██▊       | 126/458 [00:16<00:48,  6.87it/s]Validation Progress:  28%|██▊       | 127/458 [00:16<00:46,  7.05it/s]Validation Progress:  28%|██▊       | 128/458 [00:16<00:48,  6.76it/s]Validation Progress:  28%|██▊       | 129/458 [00:17<00:44,  7.37it/s]Validation Progress:  28%|██▊       | 130/458 [00:17<00:42,  7.66it/s]Validation Progress:  29%|██▊       | 131/458 [00:17<00:40,  8.06it/s]Validation Progress:  29%|██▉       | 133/458 [00:17<00:36,  8.86it/s]Validation Progress:  29%|██▉       | 134/458 [00:17<00:38,  8.37it/s]Validation Progress:  30%|██▉       | 136/458 [00:17<00:35,  9.20it/s]Validation Progress:  30%|██▉       | 137/458 [00:17<00:35,  9.14it/s]Validation Progress:  30%|███       | 138/458 [00:18<00:37,  8.44it/s]Validation Progress:  30%|███       | 139/458 [00:18<00:38,  8.38it/s]Validation Progress:  31%|███       | 140/458 [00:18<00:37,  8.45it/s]Validation Progress:  31%|███       | 141/458 [00:18<00:37,  8.52it/s]Validation Progress:  31%|███       | 142/458 [00:18<00:37,  8.51it/s]Validation Progress:  31%|███▏      | 144/458 [00:18<00:34,  9.12it/s]Validation Progress:  32%|███▏      | 146/458 [00:18<00:33,  9.42it/s]Validation Progress:  32%|███▏      | 148/458 [00:19<00:33,  9.38it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  33%|███▎      | 150/458 [00:19<00:33,  9.30it/s]Validation Progress:  33%|███▎      | 151/458 [00:19<00:33,  9.05it/s]Validation Progress:  33%|███▎      | 152/458 [00:19<00:34,  8.95it/s]Validation Progress:  33%|███▎      | 153/458 [00:19<00:35,  8.54it/s]Validation Progress:  34%|███▎      | 154/458 [00:19<00:35,  8.64it/s]Validation Progress:  34%|███▍      | 155/458 [00:19<00:35,  8.59it/s]Validation Progress:  34%|███▍      | 156/458 [00:20<00:35,  8.56it/s]Validation Progress:  34%|███▍      | 157/458 [00:20<00:37,  8.08it/s]Validation Progress:  34%|███▍      | 158/458 [00:20<00:38,  7.81it/s]Validation Progress:  35%|███▍      | 159/458 [00:20<00:39,  7.53it/s]Validation Progress:  35%|███▍      | 160/458 [00:20<00:38,  7.67it/s]Validation Progress:  35%|███▌      | 161/458 [00:20<00:37,  7.93it/s]Validation Progress:  35%|███▌      | 162/458 [00:20<00:35,  8.28it/s]Validation Progress:  36%|███▌      | 164/458 [00:21<00:33,  8.76it/s]Validation Progress:  36%|███▌      | 165/458 [00:21<00:35,  8.17it/s]Validation Progress:  36%|███▌      | 166/458 [00:21<00:34,  8.37it/s]Validation Progress:  36%|███▋      | 167/458 [00:21<00:34,  8.45it/s]Validation Progress:  37%|███▋      | 168/458 [00:21<00:34,  8.34it/s]Validation Progress:  37%|███▋      | 169/458 [00:21<00:35,  8.11it/s]Validation Progress:  37%|███▋      | 170/458 [00:21<00:34,  8.31it/s]Validation Progress:  37%|███▋      | 171/458 [00:21<00:34,  8.41it/s]Validation Progress:  38%|███▊      | 172/458 [00:22<00:33,  8.56it/s]Validation Progress:  38%|███▊      | 173/458 [00:22<00:32,  8.78it/s]Validation Progress:  38%|███▊      | 175/458 [00:22<00:30,  9.29it/s]Validation Progress:  38%|███▊      | 176/458 [00:22<00:30,  9.16it/s]Validation Progress:  39%|███▊      | 177/458 [00:22<00:30,  9.11it/s]Validation Progress:  39%|███▉      | 179/458 [00:22<00:28,  9.92it/s]Validation Progress:  39%|███▉      | 180/458 [00:22<00:28,  9.79it/s]Validation Progress:  40%|███▉      | 182/458 [00:23<00:28,  9.59it/s]Validation Progress:  40%|███▉      | 183/458 [00:23<00:30,  8.99it/s]Validation Progress:  40%|████      | 184/458 [00:23<00:29,  9.20it/s]Validation Progress:  40%|████      | 185/458 [00:23<00:29,  9.38it/s]Validation Progress:  41%|████      | 186/458 [00:23<00:30,  8.94it/s]Validation Progress:  41%|████      | 187/458 [00:23<00:32,  8.46it/s]Validation Progress:  41%|████      | 188/458 [00:23<00:33,  8.14it/s]Validation Progress:  41%|████▏     | 189/458 [00:23<00:33,  7.93it/s]Validation Progress:  41%|████▏     | 190/458 [00:24<00:35,  7.60it/s]Validation Progress:  42%|████▏     | 191/458 [00:24<00:36,  7.24it/s]Validation Progress:  42%|████▏     | 192/458 [00:24<00:38,  6.99it/s]Validation Progress:  42%|████▏     | 193/458 [00:24<00:35,  7.45it/s]Validation Progress:  42%|████▏     | 194/458 [00:24<00:35,  7.46it/s]Validation Progress:  43%|████▎     | 195/458 [00:24<00:35,  7.32it/s]Validation Progress:  43%|████▎     | 196/458 [00:24<00:35,  7.41it/s]Validation Progress:  43%|████▎     | 197/458 [00:25<00:34,  7.65it/s]Validation Progress:  43%|████▎     | 198/458 [00:25<00:32,  7.88it/s]Validation Progress:  43%|████▎     | 199/458 [00:25<00:32,  8.04it/s][2025-03-28 22:35:18,401][train_val_withOT_mpdd.py][line: 372][    INFO] Test: [200/458]	Time 0.124 (0.127)Validation Progress:  44%|████▎     | 200/458 [00:25<00:32,  8.04it/s]Validation Progress:  44%|████▍     | 201/458 [00:25<00:30,  8.31it/s]Validation Progress:  44%|████▍     | 202/458 [00:25<00:30,  8.27it/s]Validation Progress:  44%|████▍     | 203/458 [00:25<00:32,  7.74it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  45%|████▍     | 204/458 [00:25<00:33,  7.57it/s]Validation Progress:  45%|████▍     | 205/458 [00:26<00:35,  7.09it/s]Validation Progress:  45%|████▍     | 206/458 [00:26<00:36,  6.91it/s]Validation Progress:  45%|████▌     | 207/458 [00:26<00:37,  6.71it/s]Validation Progress:  45%|████▌     | 208/458 [00:26<00:35,  7.14it/s]Validation Progress:  46%|████▌     | 209/458 [00:26<00:34,  7.26it/s]Validation Progress:  46%|████▌     | 210/458 [00:26<00:32,  7.56it/s]Validation Progress:  46%|████▌     | 211/458 [00:26<00:31,  7.80it/s]Validation Progress:  46%|████▋     | 212/458 [00:26<00:31,  7.85it/s]Validation Progress:  47%|████▋     | 213/458 [00:27<00:30,  8.12it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  47%|████▋     | 214/458 [00:27<00:30,  8.10it/s]Validation Progress:  47%|████▋     | 215/458 [00:27<00:30,  8.01it/s]Validation Progress:  47%|████▋     | 216/458 [00:27<00:30,  7.95it/s]Validation Progress:  47%|████▋     | 217/458 [00:27<00:30,  7.88it/s]Validation Progress:  48%|████▊     | 218/458 [00:27<00:32,  7.49it/s]Validation Progress:  48%|████▊     | 219/458 [00:27<00:33,  7.17it/s]Validation Progress:  48%|████▊     | 220/458 [00:28<00:31,  7.46it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  48%|████▊     | 221/458 [00:28<00:31,  7.56it/s]Validation Progress:  48%|████▊     | 222/458 [00:28<00:30,  7.85it/s]Validation Progress:  49%|████▊     | 223/458 [00:28<00:28,  8.37it/s]Validation Progress:  49%|████▉     | 225/458 [00:28<00:26,  8.85it/s]Validation Progress:  49%|████▉     | 226/458 [00:28<00:27,  8.39it/s]Validation Progress:  50%|████▉     | 227/458 [00:28<00:27,  8.32it/s]Validation Progress:  50%|████▉     | 228/458 [00:28<00:29,  7.77it/s]Validation Progress:  50%|█████     | 229/458 [00:29<00:28,  8.03it/s]Validation Progress:  50%|█████     | 230/458 [00:29<00:27,  8.28it/s]Validation Progress:  50%|█████     | 231/458 [00:29<00:28,  7.90it/s]Validation Progress:  51%|█████     | 232/458 [00:29<00:28,  7.99it/s]Validation Progress:  51%|█████     | 233/458 [00:29<00:26,  8.34it/s]Validation Progress:  51%|█████     | 234/458 [00:29<00:26,  8.61it/s]Validation Progress:  51%|█████▏    | 235/458 [00:29<00:26,  8.52it/s]Validation Progress:  52%|█████▏    | 236/458 [00:29<00:26,  8.33it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  52%|█████▏    | 237/458 [00:30<00:26,  8.38it/s]Validation Progress:  52%|█████▏    | 238/458 [00:30<00:25,  8.71it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  52%|█████▏    | 239/458 [00:30<00:24,  9.05it/s]Validation Progress:  52%|█████▏    | 240/458 [00:30<00:23,  9.28it/s]Validation Progress:  53%|█████▎    | 241/458 [00:30<00:23,  9.05it/s]Validation Progress:  53%|█████▎    | 242/458 [00:30<00:23,  9.31it/s]Validation Progress:  53%|█████▎    | 243/458 [00:30<00:23,  9.03it/s]Validation Progress:  53%|█████▎    | 244/458 [00:30<00:23,  9.20it/s]Validation Progress:  53%|█████▎    | 245/458 [00:30<00:23,  9.22it/s]Validation Progress:  54%|█████▎    | 246/458 [00:31<00:23,  9.09it/s]Validation Progress:  54%|█████▍    | 247/458 [00:31<00:23,  9.17it/s]Validation Progress:  54%|█████▍    | 248/458 [00:31<00:23,  8.85it/s]Validation Progress:  54%|█████▍    | 249/458 [00:31<00:23,  8.89it/s]Validation Progress:  55%|█████▍    | 250/458 [00:31<00:24,  8.62it/s]Validation Progress:  55%|█████▍    | 251/458 [00:31<00:23,  8.68it/s]Validation Progress:  55%|█████▌    | 252/458 [00:31<00:24,  8.49it/s]Validation Progress:  55%|█████▌    | 253/458 [00:31<00:24,  8.38it/s]Validation Progress:  55%|█████▌    | 254/458 [00:31<00:24,  8.37it/s]Validation Progress:  56%|█████▌    | 255/458 [00:32<00:23,  8.54it/s]Validation Progress:  56%|█████▌    | 256/458 [00:32<00:22,  8.82it/s]Validation Progress:  56%|█████▋    | 258/458 [00:32<00:21,  9.40it/s]Validation Progress:  57%|█████▋    | 260/458 [00:32<00:19,  9.95it/s]Validation Progress:  57%|█████▋    | 262/458 [00:32<00:19, 10.22it/s]Validation Progress:  58%|█████▊    | 264/458 [00:32<00:19,  9.77it/s]Validation Progress:  58%|█████▊    | 266/458 [00:33<00:19,  9.83it/s]Validation Progress:  58%|█████▊    | 267/458 [00:33<00:19,  9.74it/s]Validation Progress:  59%|█████▊    | 268/458 [00:33<00:19,  9.74it/s]Validation Progress:  59%|█████▊    | 269/458 [00:33<00:19,  9.55it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  59%|█████▉    | 270/458 [00:33<00:20,  9.35it/s]Validation Progress:  59%|█████▉    | 271/458 [00:33<00:20,  9.15it/s]Validation Progress:  59%|█████▉    | 272/458 [00:33<00:21,  8.79it/s]Validation Progress:  60%|█████▉    | 274/458 [00:34<00:19,  9.36it/s]Validation Progress:  60%|██████    | 275/458 [00:34<00:19,  9.30it/s]Validation Progress:  60%|██████    | 276/458 [00:34<00:19,  9.25it/s]Validation Progress:  61%|██████    | 278/458 [00:34<00:18,  9.77it/s]Validation Progress:  61%|██████    | 279/458 [00:34<00:18,  9.69it/s]Validation Progress:  61%|██████    | 280/458 [00:34<00:19,  9.32it/s]Validation Progress:  61%|██████▏   | 281/458 [00:34<00:19,  9.03it/s]Validation Progress:  62%|██████▏   | 282/458 [00:34<00:20,  8.73it/s]Validation Progress:  62%|██████▏   | 283/458 [00:35<00:21,  8.31it/s]Validation Progress:  62%|██████▏   | 284/458 [00:35<00:22,  7.84it/s]Validation Progress:  62%|██████▏   | 285/458 [00:35<00:21,  7.91it/s]Validation Progress:  62%|██████▏   | 286/458 [00:35<00:22,  7.69it/s]Validation Progress:  63%|██████▎   | 287/458 [00:35<00:23,  7.38it/s]Validation Progress:  63%|██████▎   | 288/458 [00:35<00:23,  7.29it/s]Validation Progress:  63%|██████▎   | 289/458 [00:35<00:21,  7.69it/s]Validation Progress:  63%|██████▎   | 290/458 [00:35<00:21,  8.00it/s]Validation Progress:  64%|██████▎   | 291/458 [00:36<00:20,  8.09it/s]Validation Progress:  64%|██████▍   | 292/458 [00:36<00:19,  8.35it/s]Validation Progress:  64%|██████▍   | 293/458 [00:36<00:19,  8.39it/s]Validation Progress:  64%|██████▍   | 294/458 [00:36<00:18,  8.73it/s]Validation Progress:  64%|██████▍   | 295/458 [00:36<00:18,  9.00it/s]Validation Progress:  65%|██████▍   | 296/458 [00:36<00:17,  9.27it/s]Validation Progress:  65%|██████▍   | 297/458 [00:36<00:17,  8.99it/s]Validation Progress:  65%|██████▌   | 298/458 [00:36<00:17,  9.23it/s][2025-03-28 22:35:30,125][train_val_withOT_mpdd.py][line: 372][    INFO] Test: [300/458]	Time 0.128 (0.124)Validation Progress:  66%|██████▌   | 300/458 [00:37<00:17,  9.01it/s]Validation Progress:  66%|██████▌   | 301/458 [00:37<00:17,  9.00it/s]Validation Progress:  66%|██████▌   | 302/458 [00:37<00:17,  8.88it/s]Validation Progress:  66%|██████▌   | 303/458 [00:37<00:17,  8.69it/s]Validation Progress:  66%|██████▋   | 304/458 [00:37<00:17,  8.81it/s]Validation Progress:  67%|██████▋   | 305/458 [00:37<00:17,  8.96it/s]Validation Progress:  67%|██████▋   | 306/458 [00:37<00:16,  9.01it/s]Validation Progress:  67%|██████▋   | 307/458 [00:37<00:17,  8.47it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  67%|██████▋   | 308/458 [00:38<00:19,  7.68it/s]Validation Progress:  67%|██████▋   | 309/458 [00:38<00:18,  8.10it/s]Validation Progress:  68%|██████▊   | 310/458 [00:38<00:18,  7.97it/s]Validation Progress:  68%|██████▊   | 311/458 [00:38<00:17,  8.29it/s]Validation Progress:  68%|██████▊   | 312/458 [00:38<00:17,  8.25it/s]Validation Progress:  68%|██████▊   | 313/458 [00:38<00:17,  8.39it/s]Validation Progress:  69%|██████▊   | 314/458 [00:38<00:17,  8.46it/s]Validation Progress:  69%|██████▉   | 315/458 [00:38<00:16,  8.60it/s]Validation Progress:  69%|██████▉   | 316/458 [00:38<00:16,  8.77it/s]Validation Progress:  69%|██████▉   | 317/458 [00:39<00:16,  8.50it/s]Validation Progress:  69%|██████▉   | 318/458 [00:39<00:17,  7.99it/s]Validation Progress:  70%|██████▉   | 319/458 [00:39<00:17,  7.86it/s]Validation Progress:  70%|██████▉   | 320/458 [00:39<00:18,  7.65it/s]Validation Progress:  70%|███████   | 321/458 [00:39<00:18,  7.35it/s]Validation Progress:  70%|███████   | 322/458 [00:39<00:18,  7.28it/s]Validation Progress:  71%|███████   | 323/458 [00:39<00:18,  7.13it/s]Validation Progress:  71%|███████   | 324/458 [00:40<00:18,  7.09it/s]Validation Progress:  71%|███████   | 325/458 [00:40<00:19,  6.86it/s]Validation Progress:  71%|███████   | 326/458 [00:40<00:18,  7.32it/s]Validation Progress:  71%|███████▏  | 327/458 [00:40<00:17,  7.53it/s]Validation Progress:  72%|███████▏  | 328/458 [00:40<00:16,  7.87it/s]Validation Progress:  72%|███████▏  | 329/458 [00:40<00:16,  7.91it/s]Validation Progress:  72%|███████▏  | 330/458 [00:40<00:16,  7.74it/s]Validation Progress:  72%|███████▏  | 331/458 [00:41<00:16,  7.52it/s]Validation Progress:  72%|███████▏  | 332/458 [00:41<00:16,  7.57it/s]Validation Progress:  73%|███████▎  | 333/458 [00:41<00:17,  7.31it/s]Validation Progress:  73%|███████▎  | 334/458 [00:41<00:16,  7.42it/s]Validation Progress:  73%|███████▎  | 335/458 [00:41<00:16,  7.28it/s]Validation Progress:  73%|███████▎  | 336/458 [00:41<00:17,  6.97it/s]Validation Progress:  74%|███████▎  | 337/458 [00:41<00:17,  7.10it/s]Validation Progress:  74%|███████▍  | 338/458 [00:41<00:16,  7.26it/s]Validation Progress:  74%|███████▍  | 339/458 [00:42<00:16,  7.14it/s]Validation Progress:  74%|███████▍  | 340/458 [00:42<00:15,  7.43it/s]Validation Progress:  74%|███████▍  | 341/458 [00:42<00:16,  7.05it/s]Validation Progress:  75%|███████▍  | 342/458 [00:42<00:16,  6.85it/s]Validation Progress:  75%|███████▍  | 343/458 [00:42<00:15,  7.23it/s]Validation Progress:  75%|███████▌  | 344/458 [00:42<00:14,  7.84it/s]Validation Progress:  75%|███████▌  | 345/458 [00:42<00:14,  8.03it/s]Validation Progress:  76%|███████▌  | 346/458 [00:43<00:13,  8.24it/s]Validation Progress:  76%|███████▌  | 347/458 [00:43<00:12,  8.58it/s]Validation Progress:  76%|███████▌  | 348/458 [00:43<00:12,  8.54it/s]Validation Progress:  76%|███████▌  | 349/458 [00:43<00:13,  7.98it/s]Validation Progress:  76%|███████▋  | 350/458 [00:43<00:13,  7.80it/s]Validation Progress:  77%|███████▋  | 351/458 [00:43<00:13,  7.95it/s]Validation Progress:  77%|███████▋  | 352/458 [00:43<00:13,  7.97it/s]Validation Progress:  77%|███████▋  | 353/458 [00:43<00:12,  8.10it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  77%|███████▋  | 354/458 [00:44<00:12,  8.22it/s]Validation Progress:  78%|███████▊  | 355/458 [00:44<00:12,  8.25it/s]Validation Progress:  78%|███████▊  | 356/458 [00:44<00:12,  8.24it/s]Validation Progress:  78%|███████▊  | 357/458 [00:44<00:12,  8.38it/s]Validation Progress:  78%|███████▊  | 358/458 [00:44<00:11,  8.48it/s]Validation Progress:  78%|███████▊  | 359/458 [00:44<00:11,  8.43it/s]Validation Progress:  79%|███████▊  | 360/458 [00:44<00:11,  8.21it/s]Validation Progress:  79%|███████▉  | 361/458 [00:44<00:11,  8.18it/s]Validation Progress:  79%|███████▉  | 362/458 [00:44<00:11,  8.49it/s]Validation Progress:  79%|███████▉  | 363/458 [00:45<00:11,  8.61it/s]Validation Progress:  79%|███████▉  | 364/458 [00:45<00:10,  8.55it/s]Validation Progress:  80%|███████▉  | 365/458 [00:45<00:11,  8.43it/s]Validation Progress:  80%|███████▉  | 366/458 [00:45<00:10,  8.59it/s]Validation Progress:  80%|████████  | 367/458 [00:45<00:10,  8.90it/s]Validation Progress:  81%|████████  | 369/458 [00:45<00:09,  9.41it/s]Validation Progress:  81%|████████  | 370/458 [00:45<00:09,  9.01it/s]Validation Progress:  81%|████████  | 371/458 [00:45<00:09,  9.21it/s]Validation Progress:  81%|████████  | 372/458 [00:46<00:09,  8.94it/s]Validation Progress:  81%|████████▏ | 373/458 [00:46<00:09,  8.52it/s]Validation Progress:  82%|████████▏ | 374/458 [00:46<00:09,  8.72it/s]Validation Progress:  82%|████████▏ | 375/458 [00:46<00:10,  7.76it/s]Validation Progress:  82%|████████▏ | 377/458 [00:46<00:09,  8.42it/s]Validation Progress:  83%|████████▎ | 378/458 [00:46<00:09,  8.19it/s]Validation Progress:  83%|████████▎ | 379/458 [00:46<00:09,  8.11it/s]Validation Progress:  83%|████████▎ | 380/458 [00:47<00:09,  7.97it/s]Validation Progress:  83%|████████▎ | 381/458 [00:47<00:09,  7.84it/s]Validation Progress:  83%|████████▎ | 382/458 [00:47<00:10,  7.50it/s]Validation Progress:  84%|████████▎ | 383/458 [00:47<00:10,  7.41it/s]Validation Progress:  84%|████████▍ | 384/458 [00:47<00:10,  7.28it/s]Validation Progress:  84%|████████▍ | 385/458 [00:47<00:10,  7.05it/s]Validation Progress:  84%|████████▍ | 386/458 [00:47<00:10,  7.06it/s]Validation Progress:  84%|████████▍ | 387/458 [00:48<00:09,  7.20it/s]Validation Progress:  85%|████████▍ | 388/458 [00:48<00:09,  7.60it/s]Validation Progress:  85%|████████▍ | 389/458 [00:48<00:08,  8.15it/s]Validation Progress:  85%|████████▌ | 391/458 [00:48<00:07,  9.11it/s]Validation Progress:  86%|████████▌ | 392/458 [00:48<00:07,  9.02it/s]Validation Progress:  86%|████████▌ | 393/458 [00:48<00:07,  8.66it/s]Validation Progress:  86%|████████▌ | 394/458 [00:48<00:07,  8.57it/s]Validation Progress:  86%|████████▌ | 395/458 [00:48<00:07,  8.91it/s]Validation Progress:  87%|████████▋ | 397/458 [00:49<00:06,  8.97it/s]Validation Progress:  87%|████████▋ | 398/458 [00:49<00:06,  9.01it/s]Validation Progress:  87%|████████▋ | 399/458 [00:49<00:06,  9.18it/s][2025-03-28 22:35:42,517][train_val_withOT_mpdd.py][line: 372][    INFO] Test: [400/458]	Time 0.114 (0.124)Validation Progress:  87%|████████▋ | 400/458 [00:49<00:06,  9.07it/s]Validation Progress:  88%|████████▊ | 401/458 [00:49<00:06,  8.95it/s]Validation Progress:  88%|████████▊ | 402/458 [00:49<00:06,  8.31it/s]Validation Progress:  88%|████████▊ | 403/458 [00:49<00:07,  7.77it/s]Validation Progress:  88%|████████▊ | 404/458 [00:50<00:06,  7.83it/s]Validation Progress:  88%|████████▊ | 405/458 [00:50<00:06,  8.01it/s]Validation Progress:  89%|████████▊ | 406/458 [00:50<00:06,  8.14it/s]Validation Progress:  89%|████████▉ | 407/458 [00:50<00:06,  8.35it/s]Validation Progress:  89%|████████▉ | 408/458 [00:50<00:05,  8.39it/s]Validation Progress:  90%|████████▉ | 410/458 [00:50<00:05,  9.02it/s]Validation Progress:  90%|████████▉ | 411/458 [00:50<00:05,  8.83it/s]Validation Progress:  90%|████████▉ | 412/458 [00:50<00:05,  8.78it/s]Validation Progress:  90%|█████████ | 413/458 [00:51<00:05,  8.79it/s]Validation Progress:  90%|█████████ | 414/458 [00:51<00:04,  8.82it/s]Validation Progress:  91%|█████████ | 415/458 [00:51<00:04,  8.96it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  91%|█████████ | 417/458 [00:51<00:04,  9.16it/s]Validation Progress:  91%|█████████▏| 418/458 [00:51<00:04,  8.93it/s]Validation Progress:  91%|█████████▏| 419/458 [00:51<00:04,  8.97it/s]Validation Progress:  92%|█████████▏| 420/458 [00:51<00:04,  9.03it/s]Validation Progress:  92%|█████████▏| 421/458 [00:51<00:04,  8.91it/s]Validation Progress:  92%|█████████▏| 422/458 [00:52<00:04,  8.63it/s]Validation Progress:  92%|█████████▏| 423/458 [00:52<00:03,  8.82it/s]Validation Progress:  93%|█████████▎| 424/458 [00:52<00:03,  8.80it/s]Validation Progress:  93%|█████████▎| 425/458 [00:52<00:03,  8.59it/s]Validation Progress:  93%|█████████▎| 426/458 [00:52<00:03,  8.15it/s]Validation Progress:  93%|█████████▎| 427/458 [00:52<00:03,  8.17it/s]Validation Progress:  93%|█████████▎| 428/458 [00:52<00:03,  8.29it/s]Validation Progress:  94%|█████████▎| 429/458 [00:52<00:03,  8.18it/s]Validation Progress:  94%|█████████▍| 430/458 [00:53<00:03,  7.98it/s]Validation Progress:  94%|█████████▍| 431/458 [00:53<00:03,  8.14it/s]Validation Progress:  94%|█████████▍| 432/458 [00:53<00:03,  8.05it/s]Validation Progress:  95%|█████████▍| 433/458 [00:53<00:03,  7.92it/s]Validation Progress:  95%|█████████▍| 434/458 [00:53<00:03,  7.23it/s]libpng warning: iCCP: profile 'ICC Profile': 'GRAY': Gray color space not permitted on RGB PNGValidation Progress:  95%|█████████▌| 436/458 [00:53<00:02,  8.29it/s]Validation Progress:  95%|█████████▌| 437/458 [00:53<00:02,  8.37it/s]Validation Progress:  96%|█████████▌| 438/458 [00:54<00:02,  8.29it/s]Validation Progress:  96%|█████████▌| 439/458 [00:54<00:02,  8.15it/s]Validation Progress:  96%|█████████▌| 440/458 [00:54<00:02,  8.37it/s]Validation Progress:  96%|█████████▋| 441/458 [00:54<00:02,  8.46it/s]Validation Progress:  97%|█████████▋| 443/458 [00:54<00:01,  8.82it/s]Validation Progress:  97%|█████████▋| 444/458 [00:54<00:01,  8.59it/s]Validation Progress:  97%|█████████▋| 445/458 [00:54<00:01,  8.85it/s]Validation Progress:  97%|█████████▋| 446/458 [00:54<00:01,  8.79it/s]Validation Progress:  98%|█████████▊| 447/458 [00:55<00:01,  8.52it/s]Validation Progress:  98%|█████████▊| 448/458 [00:55<00:01,  8.29it/s]Validation Progress:  98%|█████████▊| 449/458 [00:55<00:01,  8.12it/s]Validation Progress:  98%|█████████▊| 450/458 [00:55<00:00,  8.14it/s]Validation Progress:  98%|█████████▊| 451/458 [00:55<00:00,  8.24it/s]Validation Progress:  99%|█████████▊| 452/458 [00:55<00:00,  8.48it/s]Validation Progress:  99%|█████████▉| 453/458 [00:55<00:00,  8.53it/s]Validation Progress:  99%|█████████▉| 454/458 [00:55<00:00,  8.48it/s]Validation Progress:  99%|█████████▉| 455/458 [00:55<00:00,  8.87it/s]Validation Progress: 100%|█████████▉| 456/458 [00:56<00:00,  9.01it/s]Validation Progress: 100%|█████████▉| 457/458 [00:56<00:00,  9.02it/s]Validation Progress: 100%|██████████| 458/458 [00:56<00:00,  8.58it/s]Validation Progress: 100%|██████████| 458/458 [00:56<00:00,  8.11it/s][2025-03-28 22:35:49,499][train_val_withOT_mpdd.py][line: 393][    INFO] Gathering final results ...[2025-03-28 22:35:49,500][train_val_withOT_mpdd.py][line: 395][    INFO]  * Loss 10.88737	total_num=458clsname metal_platelabels_cls.shape (97,)preds_cls.shape (97, 224, 224)masks_cls.shape (97, 224, 224)np.sum(labels_cls) 71np.sum(preds_cls) 582026500.0np.sum(masks_cls) 574901.06(self.scores).shape (97,)(self.masks).shape (97, 224, 224)(self.labels).shape (97,)(self.preds).shape (97, 224, 224)np.sum(self.masks) 574901.06np.sum(self.preds) 582026500.0np.sum(self.scores) 43.62491np.sum(self.labels) 71(self.scores).shape (97,)(self.masks).shape (97, 224, 224)(self.labels).shape (97,)(self.preds).shape (97, 224, 224)np.sum(self.masks) 574901.06np.sum(self.preds) 582026500.0np.sum(self.scores) 43.62491np.sum(self.labels) 71(self.scores).shape (97,)(self.masks).shape (97, 224, 224)(self.labels).shape (97,)(self.preds).shape (97, 224, 224)np.sum(self.masks) 574901.06np.sum(self.preds) 582026500.0np.sum(self.scores) 43.62491np.sum(self.labels) 71(self.scores).shape (97,)(self.masks).shape (97, 224, 224)(self.labels).shape (97,)(self.preds).shape (97, 224, 224)np.sum(self.masks) 574901.06np.sum(self.preds) 582026500.0np.sum(self.scores) 43.62491np.sum(self.labels) 71self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.1181205  0.11812053 0.11812055 ... 0.         0.         1.        ]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.1181205  1.11812053 1.11812055 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (97,)(self.masks).shape (97, 224, 224)(self.labels).shape (97,)(self.preds).shape (97, 224, 224)np.sum(self.masks) 574901.06np.sum(self.preds) 582026500.0np.sum(self.scores) 43.62491np.sum(self.labels) 71self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.1181205  0.11812053 0.11812055 ... 0.         0.         1.        ]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.1181205  1.11812053 1.11812055 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (97,)(self.masks).shape (97, 224, 224)(self.labels).shape (97,)(self.preds).shape (97, 224, 224)np.sum(self.masks) 574901.06np.sum(self.preds) 582026500.0np.sum(self.scores) 43.62491np.sum(self.labels) 71(self.scores).shape (97,)(self.masks).shape (97, 224, 224)(self.labels).shape (97,)(self.preds).shape (97, 224, 224)np.sum(self.masks) 574901.06np.sum(self.preds) 582026500.0np.sum(self.scores) 43.62491np.sum(self.labels) 71self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.1181205  0.11812053 0.11812055 ... 0.         0.         1.        ]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.1181205  1.11812053 1.11812055 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)clsname connectorlabels_cls.shape (44,)preds_cls.shape (44, 224, 224)masks_cls.shape (44, 224, 224)np.sum(labels_cls) 14np.sum(preds_cls) 233976590.0np.sum(masks_cls) 12033.0(self.scores).shape (44,)(self.masks).shape (44, 224, 224)(self.labels).shape (44,)(self.preds).shape (44, 224, 224)np.sum(self.masks) 12033.0np.sum(self.preds) 233976590.0np.sum(self.scores) 17.573957np.sum(self.labels) 14/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:160: RuntimeWarning: invalid value encountered in true_divide  f1_scores_image = (2 * precisions_image * recalls_image) / (precisions_image + recalls_image)(self.scores).shape (44,)(self.masks).shape (44, 224, 224)(self.labels).shape (44,)(self.preds).shape (44, 224, 224)np.sum(self.masks) 12033.0np.sum(self.preds) 233976590.0np.sum(self.scores) 17.573957np.sum(self.labels) 14/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:160: RuntimeWarning: invalid value encountered in true_divide  f1_scores_image = (2 * precisions_image * recalls_image) / (precisions_image + recalls_image)(self.scores).shape (44,)(self.masks).shape (44, 224, 224)(self.labels).shape (44,)(self.preds).shape (44, 224, 224)np.sum(self.masks) 12033.0np.sum(self.preds) 233976590.0np.sum(self.scores) 17.573957np.sum(self.labels) 14/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:160: RuntimeWarning: invalid value encountered in true_divide  f1_scores_image = (2 * precisions_image * recalls_image) / (precisions_image + recalls_image)(self.scores).shape (44,)(self.masks).shape (44, 224, 224)(self.labels).shape (44,)(self.preds).shape (44, 224, 224)np.sum(self.masks) 12033.0np.sum(self.preds) 233976590.0np.sum(self.scores) 17.573957np.sum(self.labels) 14self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00545036 0.00545036 0.00545037 ... 0.         0.         1.        ]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00545036 1.00545036 1.00545037 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (44,)(self.masks).shape (44, 224, 224)(self.labels).shape (44,)(self.preds).shape (44, 224, 224)np.sum(self.masks) 12033.0np.sum(self.preds) 233976590.0np.sum(self.scores) 17.573957np.sum(self.labels) 14self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00545036 0.00545036 0.00545037 ... 0.         0.         1.        ]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00545036 1.00545036 1.00545037 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (44,)(self.masks).shape (44, 224, 224)(self.labels).shape (44,)(self.preds).shape (44, 224, 224)np.sum(self.masks) 12033.0np.sum(self.preds) 233976590.0np.sum(self.scores) 17.573957np.sum(self.labels) 14(self.scores).shape (44,)(self.masks).shape (44, 224, 224)(self.labels).shape (44,)(self.preds).shape (44, 224, 224)np.sum(self.masks) 12033.0np.sum(self.preds) 233976590.0np.sum(self.scores) 17.573957np.sum(self.labels) 14self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00545036 0.00545036 0.00545037 ... 0.         0.         1.        ]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00545036 1.00545036 1.00545037 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)clsname bracket_whitelabels_cls.shape (60,)preds_cls.shape (60, 224, 224)masks_cls.shape (60, 224, 224)np.sum(labels_cls) 30np.sum(preds_cls) 322374530.0np.sum(masks_cls) 877.0(self.scores).shape (60,)(self.masks).shape (60, 224, 224)(self.labels).shape (60,)(self.preds).shape (60, 224, 224)np.sum(self.masks) 877.0np.sum(self.preds) 322374530.0np.sum(self.scores) 28.1701np.sum(self.labels) 30(self.scores).shape (60,)(self.masks).shape (60, 224, 224)(self.labels).shape (60,)(self.preds).shape (60, 224, 224)np.sum(self.masks) 877.0np.sum(self.preds) 322374530.0np.sum(self.scores) 28.1701np.sum(self.labels) 30(self.scores).shape (60,)(self.masks).shape (60, 224, 224)(self.labels).shape (60,)(self.preds).shape (60, 224, 224)np.sum(self.masks) 877.0np.sum(self.preds) 322374530.0np.sum(self.scores) 28.1701np.sum(self.labels) 30(self.scores).shape (60,)(self.masks).shape (60, 224, 224)(self.labels).shape (60,)(self.preds).shape (60, 224, 224)np.sum(self.masks) 877.0np.sum(self.preds) 322374530.0np.sum(self.scores) 28.1701np.sum(self.labels) 30self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [2.91307929e-04 2.91308026e-04 2.91308123e-04 ... 0.00000000e+00 0.00000000e+00 1.00000000e+00]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00029131 1.00029131 1.00029131 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (60,)(self.masks).shape (60, 224, 224)(self.labels).shape (60,)(self.preds).shape (60, 224, 224)np.sum(self.masks) 877.0np.sum(self.preds) 322374530.0np.sum(self.scores) 28.1701np.sum(self.labels) 30self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [2.91307929e-04 2.91308026e-04 2.91308123e-04 ... 0.00000000e+00 0.00000000e+00 1.00000000e+00]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00029131 1.00029131 1.00029131 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (60,)(self.masks).shape (60, 224, 224)(self.labels).shape (60,)(self.preds).shape (60, 224, 224)np.sum(self.masks) 877.0np.sum(self.preds) 322374530.0np.sum(self.scores) 28.1701np.sum(self.labels) 30(self.scores).shape (60,)(self.masks).shape (60, 224, 224)(self.labels).shape (60,)(self.preds).shape (60, 224, 224)np.sum(self.masks) 877.0np.sum(self.preds) 322374530.0np.sum(self.scores) 28.1701np.sum(self.labels) 30self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [2.91307929e-04 2.91308026e-04 2.91308123e-04 ... 0.00000000e+00 0.00000000e+00 1.00000000e+00]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00029131 1.00029131 1.00029131 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)clsname bracket_brownlabels_cls.shape (77,)preds_cls.shape (77, 224, 224)masks_cls.shape (77, 224, 224)np.sum(labels_cls) 51np.sum(preds_cls) 417040350.0np.sum(masks_cls) 17623.816(self.scores).shape (77,)(self.masks).shape (77, 224, 224)(self.labels).shape (77,)(self.preds).shape (77, 224, 224)np.sum(self.masks) 17623.816np.sum(self.preds) 417040350.0np.sum(self.scores) 35.699276np.sum(self.labels) 51(self.scores).shape (77,)(self.masks).shape (77, 224, 224)(self.labels).shape (77,)(self.preds).shape (77, 224, 224)np.sum(self.masks) 17623.816np.sum(self.preds) 417040350.0np.sum(self.scores) 35.699276np.sum(self.labels) 51(self.scores).shape (77,)(self.masks).shape (77, 224, 224)(self.labels).shape (77,)(self.preds).shape (77, 224, 224)np.sum(self.masks) 17623.816np.sum(self.preds) 417040350.0np.sum(self.scores) 35.699276np.sum(self.labels) 51(self.scores).shape (77,)(self.masks).shape (77, 224, 224)(self.labels).shape (77,)(self.preds).shape (77, 224, 224)np.sum(self.masks) 17623.816np.sum(self.preds) 417040350.0np.sum(self.scores) 35.699276np.sum(self.labels) 51self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00456212 0.00456212 0.00456213 ... 1.         1.         1.        ]recalls_pixel: [1.00000000e+00 1.00000000e+00 1.00000000e+00 ... 1.13468739e-04 5.67343697e-05 0.00000000e+00]precisions_pixel + recalls_pixel: [1.00456212 1.00456212 1.00456213 ... 1.00011347 1.00005673 1.        ](self.scores).shape (77,)(self.masks).shape (77, 224, 224)(self.labels).shape (77,)(self.preds).shape (77, 224, 224)np.sum(self.masks) 17623.816np.sum(self.preds) 417040350.0np.sum(self.scores) 35.699276np.sum(self.labels) 51self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00456212 0.00456212 0.00456213 ... 1.         1.         1.        ]recalls_pixel: [1.00000000e+00 1.00000000e+00 1.00000000e+00 ... 1.13468739e-04 5.67343697e-05 0.00000000e+00]precisions_pixel + recalls_pixel: [1.00456212 1.00456212 1.00456213 ... 1.00011347 1.00005673 1.        ](self.scores).shape (77,)(self.masks).shape (77, 224, 224)(self.labels).shape (77,)(self.preds).shape (77, 224, 224)np.sum(self.masks) 17623.816np.sum(self.preds) 417040350.0np.sum(self.scores) 35.699276np.sum(self.labels) 51(self.scores).shape (77,)(self.masks).shape (77, 224, 224)(self.labels).shape (77,)(self.preds).shape (77, 224, 224)np.sum(self.masks) 17623.816np.sum(self.preds) 417040350.0np.sum(self.scores) 35.699276np.sum(self.labels) 51self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00456212 0.00456212 0.00456213 ... 1.         1.         1.        ]recalls_pixel: [1.00000000e+00 1.00000000e+00 1.00000000e+00 ... 1.13468739e-04 5.67343697e-05 0.00000000e+00]precisions_pixel + recalls_pixel: [1.00456212 1.00456212 1.00456213 ... 1.00011347 1.00005673 1.        ]clsname tubeslabels_cls.shape (101,)preds_cls.shape (101, 224, 224)masks_cls.shape (101, 224, 224)np.sum(labels_cls) 69np.sum(preds_cls) 607162900.0np.sum(masks_cls) 41222.676(self.scores).shape (101,)(self.masks).shape (101, 224, 224)(self.labels).shape (101,)(self.preds).shape (101, 224, 224)np.sum(self.masks) 41222.676np.sum(self.preds) 607162900.0np.sum(self.scores) 32.550365np.sum(self.labels) 69(self.scores).shape (101,)(self.masks).shape (101, 224, 224)(self.labels).shape (101,)(self.preds).shape (101, 224, 224)np.sum(self.masks) 41222.676np.sum(self.preds) 607162900.0np.sum(self.scores) 32.550365np.sum(self.labels) 69(self.scores).shape (101,)(self.masks).shape (101, 224, 224)(self.labels).shape (101,)(self.preds).shape (101, 224, 224)np.sum(self.masks) 41222.676np.sum(self.preds) 607162900.0np.sum(self.scores) 32.550365np.sum(self.labels) 69(self.scores).shape (101,)(self.masks).shape (101, 224, 224)(self.labels).shape (101,)(self.preds).shape (101, 224, 224)np.sum(self.masks) 41222.676np.sum(self.preds) 607162900.0np.sum(self.scores) 32.550365np.sum(self.labels) 69self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00813473 0.00813473 0.00813474 ... 1.         1.         1.        ]recalls_pixel: [1.00000000e+00 1.00000000e+00 1.00000000e+00 ... 4.85142511e-05 2.42571255e-05 0.00000000e+00]precisions_pixel + recalls_pixel: [1.00813473 1.00813473 1.00813474 ... 1.00004851 1.00002426 1.        ](self.scores).shape (101,)(self.masks).shape (101, 224, 224)(self.labels).shape (101,)(self.preds).shape (101, 224, 224)np.sum(self.masks) 41222.676np.sum(self.preds) 607162900.0np.sum(self.scores) 32.550365np.sum(self.labels) 69self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00813473 0.00813473 0.00813474 ... 1.         1.         1.        ]recalls_pixel: [1.00000000e+00 1.00000000e+00 1.00000000e+00 ... 4.85142511e-05 2.42571255e-05 0.00000000e+00]precisions_pixel + recalls_pixel: [1.00813473 1.00813473 1.00813474 ... 1.00004851 1.00002426 1.        ](self.scores).shape (101,)(self.masks).shape (101, 224, 224)(self.labels).shape (101,)(self.preds).shape (101, 224, 224)np.sum(self.masks) 41222.676np.sum(self.preds) 607162900.0np.sum(self.scores) 32.550365np.sum(self.labels) 69(self.scores).shape (101,)(self.masks).shape (101, 224, 224)(self.labels).shape (101,)(self.preds).shape (101, 224, 224)np.sum(self.masks) 41222.676np.sum(self.preds) 607162900.0np.sum(self.scores) 32.550365np.sum(self.labels) 69self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [0.00813473 0.00813473 0.00813474 ... 1.         1.         1.        ]recalls_pixel: [1.00000000e+00 1.00000000e+00 1.00000000e+00 ... 4.85142511e-05 2.42571255e-05 0.00000000e+00]precisions_pixel + recalls_pixel: [1.00813473 1.00813473 1.00813474 ... 1.00004851 1.00002426 1.        ]clsname bracket_blacklabels_cls.shape (79,)preds_cls.shape (79, 224, 224)masks_cls.shape (79, 224, 224)np.sum(labels_cls) 47np.sum(preds_cls) 420524100.0np.sum(masks_cls) 3471.0(self.scores).shape (79,)(self.masks).shape (79, 224, 224)(self.labels).shape (79,)(self.preds).shape (79, 224, 224)np.sum(self.masks) 3471.0np.sum(self.preds) 420524100.0np.sum(self.scores) 24.38424np.sum(self.labels) 47(self.scores).shape (79,)(self.masks).shape (79, 224, 224)(self.labels).shape (79,)(self.preds).shape (79, 224, 224)np.sum(self.masks) 3471.0np.sum(self.preds) 420524100.0np.sum(self.scores) 24.38424np.sum(self.labels) 47(self.scores).shape (79,)(self.masks).shape (79, 224, 224)(self.labels).shape (79,)(self.preds).shape (79, 224, 224)np.sum(self.masks) 3471.0np.sum(self.preds) 420524100.0np.sum(self.scores) 24.38424np.sum(self.labels) 47(self.scores).shape (79,)(self.masks).shape (79, 224, 224)(self.labels).shape (79,)(self.preds).shape (79, 224, 224)np.sum(self.masks) 3471.0np.sum(self.preds) 420524100.0np.sum(self.scores) 24.38424np.sum(self.labels) 47self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [8.75651883e-04 8.75652103e-04 8.75652324e-04 ... 0.00000000e+00 0.00000000e+00 1.00000000e+00]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00087565 1.00087565 1.00087565 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (79,)(self.masks).shape (79, 224, 224)(self.labels).shape (79,)(self.preds).shape (79, 224, 224)np.sum(self.masks) 3471.0np.sum(self.preds) 420524100.0np.sum(self.scores) 24.38424np.sum(self.labels) 47self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [8.75651883e-04 8.75652103e-04 8.75652324e-04 ... 0.00000000e+00 0.00000000e+00 1.00000000e+00]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00087565 1.00087565 1.00087565 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)(self.scores).shape (79,)(self.masks).shape (79, 224, 224)(self.labels).shape (79,)(self.preds).shape (79, 224, 224)np.sum(self.masks) 3471.0np.sum(self.preds) 420524100.0np.sum(self.scores) 24.38424np.sum(self.labels) 47(self.scores).shape (79,)(self.masks).shape (79, 224, 224)(self.labels).shape (79,)(self.preds).shape (79, 224, 224)np.sum(self.masks) 3471.0np.sum(self.preds) 420524100.0np.sum(self.scores) 24.38424np.sum(self.labels) 47self.masks.ravel() [0. 0. 0. ... 0. 0. 0.]self.masks.ravel().dtype float32self.masks.ravel() max: 1.0self.masks.ravel() min: 0.0precisions_pixel: [8.75651883e-04 8.75652103e-04 8.75652324e-04 ... 0.00000000e+00 0.00000000e+00 1.00000000e+00]recalls_pixel: [1. 1. 1. ... 0. 0. 0.]precisions_pixel + recalls_pixel: [1.00087565 1.00087565 1.00087565 ... 0.         0.         1.        ]/home/ZZ/anomaly/HVQ-Trans-master/utils/eval_helper1.py:192: RuntimeWarning: invalid value encountered in true_divide  f1_scores_pixel = (2 * precisions_pixel * recalls_pixel) / (precisions_pixel + recalls_pixel)evalname stdevalname maxevalname pixelevalname top250evalname IImageapevalname IImagef1maxevalname IImageaurocevalname PPixelapevalname PPixelf1maxevalname PPixelproevalname PPixelaurocevalnames ['PPixelf1max', 'PPixelap', 'max', 'IImagef1max', 'IImageauroc', 'IImageap', 'pixel', 'PPixelauroc', 'PPixelpro', 'std', 'top250'][2025-03-28 22:37:57,305][eval_helper1.py][line: 445][    INFO] |    clsname    |  PPixelf1max  |  PPixelap  |   max    |  IImagef1max  |  IImageauroc  |  IImageap  |  pixel   |  PPixelauroc  |  PPixelpro  |   std    |  top250  ||:-------------:|:-------------:|:----------:|:--------:|:-------------:|:-------------:|:----------:|:--------:|:-------------:|:-----------:|:--------:|:--------:||  metal_plate  |   0.739758    |  0.727468  | 0.976165 |   0.958333    |   0.963705    |  0.985012  | 0.965005 |   0.965012    |  0.865035   | 0.989166 | 0.963705 ||   connector   |   0.284755    |  0.177071  | 0.885714 |    0.83871    |   0.890476    |  0.686713  | 0.975183 |   0.975183    |  0.914379   | 0.609524 | 0.890476 || bracket_white |   0.0264317   | 0.00669227 | 0.787778 |   0.736842    |     0.79      |  0.820788  | 0.952525 |   0.952525    |   0.85419   | 0.553333 |   0.79   || bracket_brown |    0.3676     |  0.316652  | 0.882353 |   0.910714    |   0.886124    |  0.931432  | 0.983269 |    0.98327    |  0.887413   | 0.573906 | 0.886124 ||     tubes     |   0.380552    |  0.34519   | 0.617301 |   0.816568    |   0.643116    |  0.839169  | 0.966049 |   0.966061    |  0.870277   | 0.823822 | 0.643116 || bracket_black |   0.0336493   | 0.0141541  | 0.928191 |   0.884211    |   0.923537    |  0.951847  | 0.969089 |   0.969089    |  0.899293   | 0.688165 | 0.923537 ||     mean      |   0.305458    |  0.264538  | 0.84625  |   0.857563    |   0.849493    |  0.86916   | 0.96852  |   0.968523    |  0.881764   | 0.706319 | 0.849493 |Epoch : 29 Best Metric: 0.8651285049186231 Current Metric: 0.8462503165096583/root/anaconda3/envs/Glad/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:369: UserWarning: To get the last learning rate computed by the scheduler, please use `get_last_lr()`.  warnings.warn("To get the last learning rate computed by the scheduler, "[2025-03-28 22:38:09,871][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [30/1000]	Iter: [1651/56000]	Time 0.36 (0.44)	Data 0.00 (0.04)	Loss 8.74595 (8.60509)	LR 0.00010	/root/anaconda3/envs/Glad/lib/python3.8/site-packages/torch/optim/lr_scheduler.py:154: UserWarning: The epoch parameter in `scheduler.step()` was not necessary and is being deprecated where possible. Please use `scheduler.step()` to step the scheduler. During the deprecation, if epoch is different from None, the closed form is used instead of the new chainable form, where available. Please open an issue if you are unable to replicate your use case: https://github.com/pytorch/pytorch/issues/new/choose.  warnings.warn(EPOCH_DEPRECATION_WARNING, UserWarning)[2025-03-28 22:38:30,731][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [31/1000]	Iter: [1701/56000]	Time 0.39 (0.46)	Data 0.00 (0.07)	Loss 9.69036 (8.71898)	LR 0.00010	[2025-03-28 22:38:51,818][train_val_withOT_mpdd.py][line: 311][    INFO] Epoch: [32/1000]	Iter: [1751/56000]	Time 0.39 (0.49)	Data 0.00 (0.09)	Loss 8.35768 (8.59809)	LR 0.00010	